# 📋 AI番剧制作系统 - 需求文档

## 项目背景

设计一个AI驱动的番剧制作辅助系统，帮助创作者将小说/故事转换为完整的分镜表。

---

## 核心需求

### 1. 输入处理
- [x] 支持长文本输入（1-2万字）
- [x] 自动分析故事结构
- [x] 智能划分章节/集（每集3-15分钟）
- [x] 支持自定义导演风格
- [x] 支持设置年代/时代背景

### 2. 分层处理（重要！）
- [x] 第一层：全局章节概览（不展开细节）
- [x] 第二层：选择某一集 → 展开详细制作
- [x] 完成一集 → 返回选择下一集
- **原因：** 一次性处理太长内容会导致分析不准确

### 3. 部门制架构
- [x] 智能体不是平级的，而是按"部门"组织
- [x] 总导演统筹全局
- [x] 编剧部负责剧本和情绪
- [x] 美术部负责服化道场景
- [x] 导演部负责分镜摄影灯光调色表演
- [x] 音乐部负责配乐音效
- [x] 考据部负责历史文化

### 4. 情绪节拍系统
- [x] 每5-10秒一个情绪节拍
- [x] 8分钟 ≈ 60-80个镜头
- [x] 情绪强度1-10分
- [x] 三层分类：叙事/戏剧/情绪
- [x] 识别"无聊区"和"高光区"

### 5. 人物设定（服化道设计师）
- [x] 自动从故事提取人物
- [x] 人物小传
- [x] 外貌特征（脸型、发型、身材）
- [x] 服装设定（日常、正装）
- [x] 配色方案
- [x] 配饰
- [x] 参考图Prompt

### 6. 时代考据（历史顾问）
- [x] 时代背景分析
- [x] 文化细节
- [x] 服饰规范
- [x] 建筑风格
- [x] 时代道具
- [x] 禁忌清单（不能出现的东西）
- [x] 参考资料推荐

### 7. 导演部综合方案
每个镜头输出一个综合方案，包含：
- [x] 分镜：景别、运镜、构图、角度
- [x] 摄影：光圈、焦段、景深、机位
- [x] 灯光：主光、补光、轮廓光、比例
- [x] 调色：色温、饱和度、对比、LUT
- [x] 表演：表情、肢体、节奏、潜台词

### 8. 音乐系统
- [x] 三轨并行：主旋律/副旋律/环境音
- [x] 每轨独立控制
- [x] 动态标记（渐强/渐弱/突强/静默）
- [x] 起止时间
- [x] BPM、调式
- [x] 每镜头独立Prompt

### 9. 可编辑性
- [x] 所有输出内容可编辑
- [x] 每个阶段可返回上一步
- [x] 可重新生成

### 10. 输出格式
- [x] Excel (CSV) - 55+列完整数据
- [x] JSON - 结构化数据
- [x] Prompt复制 - 图像生成用

---

## 用户反馈记录

### 反馈1：默认数据问题
> "输入自己的小说，结果默认给我骆驼祥子的分析"

**解决：** 修改为真正分析用户输入的内容

### 反馈2：缺少返回功能
> "没有办法返回上一步"

**解决：** 每个步骤添加"返回上一步"按钮

### 反馈3：镜头数量不足
> "8分钟应该有60多个镜头，现在太少了"

**解决：** 按5-8秒/镜头计算，8分钟生成约80个镜头

### 反馈4：智能体输出不完整
> "每个镜头没显示所有智能体的想法"

**解决：** 每个镜头显示所有智能体的完整输出

### 反馈5：需要Excel格式
> "我比较偏向于Excel表格形式"

**解决：** 添加CSV导出功能，55+列

### 反馈6：智能体太散
> "灯光属于导演部，服化道属于美术部"

**解决：** 重构为部门制架构

### 反馈7：长剧本处理
> "1-2万字剧本分解不出来"

**解决：** 改为分层处理：先分章节，再逐集展开

### 反馈8：缺少服化道和考据
> "人物小传、外貌、衣服、历史场景需要分析"

**解决：** 添加服化道设计师和时代顾问

### 反馈9：音乐系统不完整
> "音乐分主旋律副旋律，需要看到每段的起点终点、渐变加强"

**解决：** 重构音乐系统为三轨+动态标记+时间线

---

## 技术实现

### 前端
- 纯HTML + CSS + JavaScript
- 无需框架，轻量化
- 响应式设计

### 部署
- Python http.server 本地服务
- localhost.run SSH隧道公网访问

### 后续可扩展
- 接入Claude API做真正的AI分析
- 接入Midjourney做预览图生成
- 数据库存储项目

---

## 版本记录

| 版本 | 日期 | 更新内容 |
|------|------|---------|
| v1.0 | 2026-02-14 | 初版，平级智能体 |
| v2.0 | 2026-02-14 | 部门制+分层处理+音乐系统 |
